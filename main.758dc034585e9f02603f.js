!function(e){function t(t){for(var n,a,l=t[0],r=t[1],c=t[2],u=0,d=[];u<l.length;u++)a=l[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);for(h&&h(t);d.length;)d.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,l=1;l<i.length;l++){var r=i[l];0!==o[r]&&(n=!1)}n&&(s.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},o={0:0},s=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var l=window.webpackJsonp=window.webpackJsonp||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var h=r;s.push([132,1]),i()}({132:function(e,t,i){i(133),e.exports=i(328)},319:function(e,t,i){},327:function(e,t){},328:function(e,t,i){"use strict";i.r(t);i(319);function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ingameMenuItems={exitToMenu:{text:"exit to menu",enabled:!0}},this.menuItems={newGame:{text:"new game",enabled:!0,items:{seed:{text:"seed",settingname:"seed",value:window.globeAPPsettings.seed,type:"text"},difficulties:{text:"difficulty",settingname:"difficulty",value:window.globeAPPsettings.difficulties,type:"select"},planetCount:{text:"planets",settingname:"planetCount",value:window.globeAPPsettings.planetCount,type:"number"},character:{text:"character",settingname:"character",value:window.globeAPPsettings.characters,type:"select"},color:{text:"color",settingname:"color",value:window.globeAPPsettings.color,type:"text"},startButton:{text:"GO",settingname:"GO",value:"singleplayer",type:"button"}}},loadGame:{text:"load game",enabled:!1,items:{savedGameFile:{text:"saved game file",settingname:"savedGameFile",value:window.globeAPPsettings.savedGameFile,type:"text/file"},loadGameButton:{text:"load game",settingname:"loadGameButton",value:"loadgame",type:"button"}}},multiplayer:{text:"multiplayer",enabled:!1,items:{character:{text:"character",settingname:"character",value:window.globeAPPsettings.characters,type:"select"},color:{text:"color",settingname:"color",value:window.globeAPPsettings.color,type:"text"},server:{text:"server",settingname:"server",value:window.globeAPPsettings.server,type:"text"},connectButton:{text:"connect",settingname:"connectButton",value:"multiplayer",type:"button"}}},options:{text:"options",enabled:!1,items:{sound:{text:"sound",settingname:"sound",value:window.globeAPPsettings.options.sound,type:"boolean"},controls:{text:"controls",settingname:"controls",value:{forward:window.globeAPPsettings.options.controls.forward,backwards:window.globeAPPsettings.options.controls.backwards,strafeleft:window.globeAPPsettings.options.controls.strafeleft,straferight:window.globeAPPsettings.options.controls.straferight,turnleft:window.globeAPPsettings.options.controls.turnleft,turnright:window.globeAPPsettings.options.controls.turnright,jump:window.globeAPPsettings.options.controls.jump,dash:window.globeAPPsettings.options.controls.dash,dive:window.globeAPPsettings.options.controls.dive,action1:window.globeAPPsettings.options.controls.action1,action2:window.globeAPPsettings.options.controls.action2,action3:window.globeAPPsettings.options.controls.action3,action4:window.globeAPPsettings.options.controls.action4,action5:window.globeAPPsettings.options.controls.action5,action6:window.globeAPPsettings.options.controls.action6,action7:window.globeAPPsettings.options.controls.action7,action8:window.globeAPPsettings.options.controls.action8,action9:window.globeAPPsettings.options.controls.action9,action10:window.globeAPPsettings.options.controls.action10},type:"select"},graphics:{text:"graphics",settingname:"graphics",value:{viewdistance:window.globeAPPsettings.options.graphics.viewdistance,texturequality:window.globeAPPsettings.options.graphics.texturequality},type:"select"}}}},this.menuElement=null,this.init()}var t,i,o;return t=e,(i=[{key:"init",value:function(){this.menuElement=this.h2e('<div id="gameMenu"></div>'),document.body.appendChild(this.menuElement),this.buildMenu(this.menuItems)}},{key:"setMenuState",value:function(e){console.log(e)}},{key:"setGameState",value:function(e){"singleplayer"===e&&(this.menuElement.className="hideMenu",window.globeapp.stateChange("singleplayer")),"multiplayer"===e&&(this.menuElement.className="hideMenu",window.globeapp.stateChange("multiplayer")),"menu"===e&&window.globeapp.stateChange("menu")}},{key:"loadGame",value:function(e){console.log(e)}},{key:"changeSetting",value:function(e,t){window.globeAPPsettings[e]=t}},{key:"buildMenu",value:function(e){var t=this,i=function(i){var n=e[i];if(n.enabled){var o=t.h2e('<div class="menu--row"><div class="menu--row--label">'.concat(n.text,"</div></div>"));o.onclick=function(){t.handleMenuRowClick(o,n)},t.menuElement.appendChild(o)}};for(var n in e)i(n)}},{key:"handleMenuRowClick",value:function(e,t){if(this.menuElement.innerHTML="",t.items)for(var i in t.items){var n=t.items[i];if("button"!==n.type){var o=this.h2e('<div class="menu--row"><div class="menu--row--label">'.concat(n.text,"</div></div>"));o.appendChild(this.menuPart(n)),this.menuElement.appendChild(o)}else{var s=this.h2e('<div class="menu--row"></div>');s.appendChild(this.menuPart(n)),this.menuElement.appendChild(s)}}else location.reload()}},{key:"menuPart",value:function(e){var t=this,i=null;return"button"===e.type?(i=this.h2e('<div class="menu--input--Button">'.concat(e.text,"</div>"))).onclick=function(){t.setGameState(e.value)}:"text"===e.type?(i=this.h2e('<input type="text" value="'.concat(e.value,'" class="menu--input--Text"/>'))).onchange=function(n){t.changeSetting(e.settingname,i.value)}:"number"===e.type?(i=this.h2e('<input type="text" value="'.concat(e.value,'" class="menu--input--Number"/>'))).onchange=function(n){var o=parseInt(i.value)||1;o<1&&(o=1),t.changeSetting(e.settingname,o)}:"select"===e.type?(i=this.h2e('<select class="menu--input--Select" value="'.concat(window.globeAPPsettings[e.text],'">').concat(this.menuPartSelect(e),"</select>"))).onchange=function(){t.changeSetting(e.settingname,i.value)}:"file"===e.type?i=this.h2e('<input type="file" class="menu--input--File"/>'):"boolean"===e.type&&(i=this.h2e('<input type="checkbox" class="menu--input--Boolean"/>')),i}},{key:"toggleMenu",value:function(){this.menuElement.classList.toggle("hideMenu"),this.menuElement.classList.contains("hideMenu")||(this.menuElement.innerHTML="",this.buildMenu(this.ingameMenuItems))}},{key:"menuPartSelect",value:function(e){for(var t="",i=0;i<e.value.length;i++)t+='<option value="'.concat(e.value[i],'" ').concat(e.value[i]===window.globeAPPsettings[e.text]?"selected":"",">").concat(e.value[i],"</option>");return t}},{key:"h2e",value:function(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}])&&n(t.prototype,i),o&&n(t,o),e}(),s=i(0),a=i(6),l=i(126),r=i(127),c=i(128),h=i(131);function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t.model,this.color=t.color,this.scene=i,this.onload=n,this.userData=null,this.modelObj={name:t.model,states:["Idle","Walking","Crouch","Running","Dance","Death","Sitting","Standing"],emotes:["Jump","Yes","No","Wave","Punch","ThumbsUp"],actions:{},api:{state:"Idle"},model:null,mixer:null,activeAction:null,previousAction:null,changeState:!1},this.loaders={gltf:(new l.a).setPath("/planets/assets/models/"),collada:(new h.a).setPath("/planets/assets/models/"),draco:(new r.a).setPath("/planets/assets/models/"),obj:(new c.a).setPath("/planets/assets/models/")},this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.loadmodel()}},{key:"loadmodel",value:function(){"robot"===this.model?this.loadRobot():"alien"===this.model?this.loadAlien():this.loadRobot()}},{key:"toRad",value:function(e){return e*(Math.PI/180)}},{key:"loadRobot",value:function(){var e=this;this.loaders.gltf.load("gltf/RobotExpressive/RobotExpressive.glb",(function(t){e.modelObj.data=t,e.modelObj.model=t.scene,e.modelObj.model.name="robot",e.modelObj.model.scale.set(25,25,25),e.modelObj.model.position.set(0,0,0),e.scene.add(e.modelObj.model),e.modelObj.model.userData.modelname="robot",e.modelObj.model.rotateY(e.toRad(180)),e.modelObj.model.rotateX(e.toRad(90)),e.modelObj.mixer=new s.c(e.modelObj.model);for(var i=0;i<t.animations.length;i++){var n=t.animations[i],o=e.modelObj.mixer.clipAction(n);e.modelObj.actions[n.name]=o,(e.modelObj.emotes.indexOf(n.name)>=0||e.modelObj.states.indexOf(n.name)>=4)&&(o.clampWhenFinished=!0,o.loop=s.M)}"function"==typeof e.onload&&e.onload(),e.modelObj.activeAction=e.modelObj.actions.Idle,e.animateObject()}))}},{key:"loadAlien",value:function(){var e=this;this.loaders.gltf.load("alien.glb",(function(t){e.modelObj.data=t,e.modelObj.model=t.scene.children[0],e.modelObj.model.name="alien",e.scene.add(e.modelObj.model),e.loaded=!0,e.modelObj.model.scale.set(25,25,25),e.modelObj.model.rotateY(e.toRad(0)),e.modelObj.model.rotateZ(e.toRad(180)),e.modelObj.model.rotateX(e.toRad(85)),e.modelObj.model.children[1].material.metalness=.4,e.modelObj.model.children[1].material.roughness=0,e.modelObj.model.children[1].material.depthWrite=!0,e.modelObj.model.children[1].material.color=new s.l(e.color),e.modelObj.model.children[1].castShadow=!0,e.modelObj.model.position.y+=20,e.modelObj.mixer=new s.c(e.modelObj.model);for(var i=0;i<t.animations.length;i++){var n=t.animations[i],o=e.modelObj.mixer.clipAction(n);e.modelObj.actions[n.name]=o,(e.modelObj.emotes.indexOf(n.name)>=0||e.modelObj.states.indexOf(n.name)>=4)&&(o.clampWhenFinished=!0,o.loop=s.M)}"function"==typeof e.onload&&e.onload(),e.modelObj.activeAction=e.modelObj.actions.Idle,e.animateObject()}))}},{key:"animateMe",value:function(e){"alien"===this.modelObj.name&&"Sitting"===e&&(e="Crouch"),this.modelObj.api.state!==e&&(this.modelObj.api.state=e,this.animateObject())}},{key:"animateObject",value:function(){this.fadeToAction(this.modelObj.api.state,.5),this.modelObj.activeAction.play()}},{key:"fadeToAction",value:function(e,t){this.modelObj.previousAction=this.modelObj.activeAction,this.modelObj.activeAction=this.modelObj.actions[e],this.modelObj.previousAction!==this.modelObj.activeAction&&this.modelObj.previousAction.fadeOut(t),this.modelObj.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(t).play()}}])&&u(t.prototype,i),n&&u(t,n),e}(),p=i(129);function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos={x:0,y:t.globeRadius+20,z:0},this.posy=new s.Db(0,t.globeRadius+20,0),this.quat={x:0,y:0,z:0,w:1},this.mass=1,this.planets=t.planets,this.camera=t.camera,this.tempcamera=null,this.axesHelper=null,this.controls=null,this.damageDelay=!0,this.menu=!1,this.dead=!1,this.playerObject=null,this.globeRadius=t.globeRadius,this.oldquat=new s.jb,this.playerTimer=null,this.playerStartTime=Date.now(),this.skill={skillDrop:null,use:!1,clock:new s.k,obj:null,geometry:null,inUse:!1},this.scene=t.scene,this.attributes={health:{amount:100,regen:!0,modifier:1},energy:{amount:100,regen:!0,modifier:1},defense:{amount:100,modifier:1},speed:{amount:100,modifier:1},damage:{amount:100,modifier:1},gravity:{modifier:1},bounce:{modifier:1}},this.moveDirection={left:0,right:0,forward:0,back:0,jump:0,strafeRight:0,strafeLeft:0,dive:0,dash:0},this.closestDist=null,this.closestPlanet={number:0,planet:this.planets[0]},this.nq=new s.cb,this.raycasterX=null,this.raycasterY=null,this.raycasterZ=null,this.clock=new s.k,this.jumps=2,this.dashes=1,this.prevTime=Date.now(),this.amirotating=!1,this.isMoving=!1,this.modelsloaded=1,this.avatar=null,this.renderer=t.renderer,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.playerGeometry=new s.f(15,15,15),this.playerGeometry.rotateX(.5*Math.PI);var e=this.playerObject=new s.R(this.playerGeometry,new s.U({color:16712965,opacity:0,transparent:!0}));this.oldquat.copy(this.playerObject.getWorldQuaternion()),e.position.set(this.pos.x,this.pos.y,this.pos.z);var t=new s.a(4210752);t.intensity=.5,e.add(t),e.castShadow=!0,e.receiveShadow=!0,window.scene.add(e),e.add(this.camera),this.skill.geometry=new s.tb(1),this.skill.obj=new s.R(this.skill.geometry,new s.U({color:16712965})),this.skill.obj.position.set(0,0,-50),e.add(this.skill.obj);var i=this.playerObject.getWorldPosition(),n=new s.Db(this.playerObject.matrixWorld.elements[0],this.playerObject.matrixWorld.elements[1],this.playerObject.matrixWorld.elements[2]),o=new s.Db(this.playerObject.matrixWorld.elements[4],this.playerObject.matrixWorld.elements[5],this.playerObject.matrixWorld.elements[6]),l=new s.Db(this.playerObject.matrixWorld.elements[8],this.playerObject.matrixWorld.elements[9],this.playerObject.matrixWorld.elements[10]),r=new s.Db;r.copy(n).negate();var c=new s.Db;c.copy(o).negate(),this.raycasterX=new s.nb(i,n,0,30),this.raycasterY=new s.nb(i,o,0,30),this.raycasterZ=new s.nb(i,l,0,30),this.raycasterXn=new s.nb(i,r,0,30),this.raycasterYn=new s.nb(i,c,0,30);var h=Math.abs(this.playerObject.position.distanceTo(this.closestPlanet.planet.globeObject.getWorldPosition()));this.closestDist=h-this.closestPlanet.planet.globeRadius,this.camera.position.set(0,100,-1200),this.camera.lookAt(this.playerObject.getWorldPosition()),this.tempcamera=this.camera.clone(),this.controls=new p.a(this.tempcamera,this.renderer.domElement),this.physicsBody=new a.a({mass:this.mass,position:new a.d(this.pos.x,this.pos.y,this.pos.z),shape:new a.b(new a.d(15,15,15)),velocity:new a.d(0,0,0),angularVelocity:new a.d(0,0,0),linearDamping:.85,angularDamping:.15,restitution:0});var u={model:window.globeAPPsettings.character,color:window.globeAPPsettings.color};this.avatar=new d(u,this.playerObject,(function(){return!1})),this.setupEventHandlers()}},{key:"setupEventHandlers",value:function(){var e=this;window.addEventListener("keydown",(function(t){e.handleKeyDown(t)}),!1),window.addEventListener("keyup",(function(t){e.handleKeyUp(t)}),!1)}},{key:"handleKeyDown",value:function(e){switch(e.key){case window.globeAPPsettings.options.controls.forward:this.moveDirection.forward=1;break;case window.globeAPPsettings.options.controls.backwards:this.moveDirection.back=1;break;case window.globeAPPsettings.options.controls.turnleft:this.moveDirection.left=1;break;case window.globeAPPsettings.options.controls.turnright:this.moveDirection.right=1;break;case window.globeAPPsettings.options.controls.jump:this.moveDirection.jump=1;break;case window.globeAPPsettings.options.controls.strafeleft:this.moveDirection.strafeLeft=1;break;case window.globeAPPsettings.options.controls.straferight:this.moveDirection.strafeRight=1;break;case window.globeAPPsettings.options.controls.dive:this.moveDirection.dive=1;break;case window.globeAPPsettings.options.controls.dash:this.moveDirection.dash=1}}},{key:"handleKeyUp",value:function(e){switch(e.key){case window.globeAPPsettings.options.controls.forward:this.moveDirection.forward=0;break;case window.globeAPPsettings.options.controls.backwards:this.moveDirection.back=0;break;case window.globeAPPsettings.options.controls.turnleft:this.moveDirection.left=0;break;case window.globeAPPsettings.options.controls.turnright:this.moveDirection.right=0;break;case window.globeAPPsettings.options.controls.jump:this.moveDirection.jump=0;break;case window.globeAPPsettings.options.controls.strafeleft:this.moveDirection.strafeLeft=0;break;case window.globeAPPsettings.options.controls.straferight:this.moveDirection.strafeRight=0;break;case window.globeAPPsettings.options.controls.dive:this.moveDirection.dive=0;break;case window.globeAPPsettings.options.controls.dash:this.moveDirection.dash=0}}},{key:"toRad",value:function(e){return e*(Math.PI/180)}},{key:"regenAttributes",value:function(){var e=this;this.dead||(this.attributes.energy.amount<100&&this.attributes.energy.regen&&(this.attributes.energy.regen=!1,this.attributes.energy.amount+=1,setTimeout((function(){e.attributes.energy.regen=!0}),150)),this.attributes.health.amount<100&&this.attributes.health.regen&&(this.attributes.health.regen=!1,this.attributes.health.amount+=1,setTimeout((function(){e.attributes.health.regen=!0}),500)))}},{key:"movePlayer",value:function(){if(!this.dead){var e=this.moveDirection.right-this.moveDirection.left,t=10*(this.moveDirection.strafeRight-this.moveDirection.strafeLeft),i=10*(this.moveDirection.back-this.moveDirection.forward),n=this.moveDirection.jump,o=this.moveDirection.dive,l=this.moveDirection.dash;if(0===e&&0===i&&0===n&&0===t&&0===o&&0===l)return this.isMoving=!1,void this.avatar.animateMe("Idle");null===this.playerTimer&&(this.playerTimer=new s.k),this.isMoving=!0;var r=new s.Db(t,i,0),c=new a.d(r.x,r.y,r.z);1===n&&this.closestDist<50?(this.playerJump(),this.avatar.animateMe("Jump")):1===o&&this.closestDist>225?(this.playerDive(),this.avatar.animateMe("Sitting")):this.avatar.animateMe("Running"),1===l&&this.attributes.energy.amount>=20&&this.playerDash(),this.physicsBody.applyLocalImpulse(c,new a.d(0,0,0))}}},{key:"playerJump",value:function(){var e=this;if(this.jumps>0&&this.closestDist<50){this.jumps-=1,setTimeout((function(){e.jumps++}),1e3);var t=new s.Db(0,0,-1200),i=new a.d(t.x,t.y,t.z);this.physicsBody.applyLocalImpulse(i,new a.d(0,0,0))}}},{key:"playerDash",value:function(){var e=this;if(this.dashes>0){this.dashes=this.dashes-1,setTimeout((function(){e.dashes++}),500);var t=new s.Db(0,-2400,0);this.changeStat("energy",-20);var i=new a.d(t.x,t.y,t.z);this.physicsBody.applyLocalImpulse(i,new a.d(0,0,0))}}},{key:"playerDive",value:function(){var e=new s.Db(0,0,700),t=new a.d(e.x,e.y,e.z);this.physicsBody.applyLocalImpulse(t,new a.d(0,0,0))}},{key:"playerBounce",value:function(e,t,i){if("number"==typeof e&&"number"==typeof t&&"number"==typeof i){var n=this.attributes.bounce.modifier,o=n*e,l=n*t,r=n*i,c=new s.Db(o,l,r),h=new a.d(c.x,c.y,c.z);this.physicsBody.applyLocalImpulse(h,new a.d(0,0,0))}}},{key:"playerTurn",value:function(){if(!this.dead){var e=this.moveDirection.right-this.moveDirection.left;0!=e&&(this.playerObject.rotateZ(this.toRad(3.5*e)),this.playerObject.quaternion.multiply(this.oldquat),this.playerObject.updateMatrixWorld())}}},{key:"getDistanceToPlanets",value:function(){var e=this.playerObject.position.distanceTo(this.closestPlanet.planet.globeObject.getWorldPosition());this.closestDist=e-this.closestPlanet.planet.globeRadius;for(var t=0;t<this.planets.length;t++){var i=this.planets[t];this.playerObject.position.distanceTo(i.globeObject.getWorldPosition())-i.globeRadius<this.closestDist&&t!==this.closestPlanet.number&&(this.closestPlanet={number:t,planet:this.planets[t]},this.amirotating=!0)}}},{key:"faceGlobe",value:function(){var e=this,t=(new s.Q).extractRotation(this.playerObject.matrixWorld),i=new s.Db(0,1,0).applyMatrix4(t).normalize();this.playerObject.up.copy(i),!1===this.amirotating?this.playerObject.lookAt(this.closestPlanet.planet.globeObject.getWorldPosition()):(this.nq.position.copy(this.playerObject.position),this.nq.quaternion.normalize().equals(this.playerObject.quaternion.normalize())?this.amirotating=!1:(this.nq.lookAt(this.closestPlanet.planet.globeObject.getWorldPosition()),this.playerObject.quaternion.slerp(this.nq.quaternion,.1),setTimeout((function(){e.amirotating=!1}),750)))}},{key:"gravPlayer",value:function(){var e=2500;"insanity"===window.globeAPPsettings.difficulty&&(e=2500*this.attributes.gravity.modifier);var t=new s.Db(0,0,e);this.amirotating&&t.copy(new s.Db(0,0,200));var i=new a.d(t.x,t.y,t.z);this.physicsBody.applyLocalForce(i,new a.d(0,0,0))}},{key:"findIntersection",value:function(){var e=this.playerObject.getWorldPosition(),t=new s.Db(this.playerObject.matrixWorld.elements[0],this.playerObject.matrixWorld.elements[1],this.playerObject.matrixWorld.elements[2]),i=new s.Db(this.playerObject.matrixWorld.elements[4],this.playerObject.matrixWorld.elements[5],this.playerObject.matrixWorld.elements[6]),n=new s.Db(this.playerObject.matrixWorld.elements[8],this.playerObject.matrixWorld.elements[9],this.playerObject.matrixWorld.elements[10]),o=new s.Db;o.copy(t).negate();var a=new s.Db;a.copy(i).negate(),this.raycasterX.set(e,t),this.raycasterY.set(e,i),this.raycasterZ.set(e,n),this.raycasterXn.set(e,o),this.raycasterYn.set(e,a);for(var l=0;l<this.closestPlanet.planet.objectList.length;l++){var r=this.raycasterX.intersectObject(this.closestPlanet.planet.objectList[l].objObject,!0),c=this.raycasterY.intersectObject(this.closestPlanet.planet.objectList[l].objObject,!0),h=this.raycasterZ.intersectObject(this.closestPlanet.planet.objectList[l].objObject,!0),u=this.raycasterXn.intersectObject(this.closestPlanet.planet.objectList[l].objObject,!0),d=this.raycasterYn.intersectObject(this.closestPlanet.planet.objectList[l].objObject,!0);(r.length>0||c.length>0||h.length>0)&&(this.playerBounce(),r.length>0&&("skill"===r[0].object.userData.type?(this.changeStat("health",r[0].object.userData.damage),this.playerBounce(r[0].object.userData.bounce,0,0)):(this.changeStat("health",-20),this.playerBounce(-2e3,0,0))),c.length>0&&("skill"===c[0].object.userData.type?(this.changeStat("health",c[0].object.userData.damage),this.playerBounce(0,c[0].object.userData.bounce,0)):(this.changeStat("health",-20),this.playerBounce(0,-2e3,0))),h.length>0&&("skill"===h[0].object.userData.type?(this.changeStat("health",h[0].object.userData.damage),this.playerBounce(0,0,h[0].object.userData.bounce)):(this.playerBounce(0,0,-2e3),this.killSlime(l)))),(u.length>0||d.length>0)&&(this.playerBounce(),u.length>0&&("skill"===u[0].object.userData.type?(this.changeStat("health",u[0].object.userData.damage),this.playerBounce(u[0].object.userData.bounce,0,0)):(this.changeStat("health",-20),this.playerBounce(2e3,0,0))),d.length>0&&("skill"===d[0].object.userData.type?(this.changeStat("health",d[0].object.userData.damage),this.playerBounce(0,d[0].object.userData.bounce,0)):(this.changeStat("health",-20),this.playerBounce(0,2e3,0))))}}},{key:"killSlime",value:function(e){this.closestPlanet.planet.globeObject.remove(this.closestPlanet.planet.objectList[e].objObject),this.closestPlanet.planet.objectList.splice(e,1)}},{key:"skillUse",value:function(){var e=this,t=this.skill.clock.getElapsedTime();!this.skill.inUse&&this.skill.use?(this.skill.inUse=!0,setTimeout((function(){e.skill.inUse=!1}),250)):this.skill.inUse?t>=.25?(this.skill.obj.scale.set(0,0,0),this.skill.obj.position.set(0,0,-50),this.skill.obj.visible=!1):(this.skill.obj.visible=!0,this.skill.obj.scale.x=75-75*Math.exp(-5*t),this.skill.obj.scale.y=75-75*Math.exp(-5*t),this.skill.obj.scale.z=75-75*Math.exp(-5*t),this.skill.obj.position.y-=500*t):(this.skill.clock=new s.k,this.skill.obj.scale.set(0,0,0),this.skill.obj.position.set(0,0,-50),this.skill.geometry.visible=!1)}},{key:"changeStat",value:function(e,t,i){var n=this;if(i&&this.attributes[e].amount<Math.abs(t))return!1;this.damageDelay&&"health"===e?(this.damageDelay=!1,"insanity"===window.globeAPPsettings.difficulty&&(this.attributes.gravity.modifier+=-.1,this.attributes.bounce.modifier+=.1),setTimeout((function(){n.damageDelay=!0}),100),this.attributes[e].amount+=t):this.attributes[e].amount+=t}},{key:"healthCheck",value:function(){this.attributes.health.amount<1&&(this.dead=!0,this.deathHandler())}},{key:"deathHandler",value:function(){"robot"===this.avatar.model?this.avatar.animateMe("Death"):"alien"===this.avatar.model&&this.avatar.animateMe("TPose"),null!==this.playerTimer&&this.playerTimer.stop(),this.menu||(this.menu=!0,window.globeapp.stateChange("menu"))}},{key:"globeLoop",value:function(){for(var e=0;e<this.closestPlanet.planet.objectList.length;e++)"tower"===this.closestPlanet.planet.objectList[e].objObject.userData.type&&this.closestPlanet.planet.objectList[e].objRenderLoop()}},{key:"loop",value:function(){this.controls&&this.playerObject&&(this.camera.copy(this.tempcamera),this.controls.update()),this.globeLoop(),this.healthCheck(),this.skillUse(),this.physicsBody.quaternion.copy(this.playerObject.quaternion),this.playerObject.position.copy(this.physicsBody.position),this.regenAttributes(),this.getDistanceToPlanets(),this.findIntersection(),this.playerObject.updateMatrixWorld();var e=this.clock.getDelta();this.avatar.modelObj.mixer&&this.avatar.modelObj.mixer.update(e),this.movePlayer(),this.faceGlobe(),this.playerTurn(),this.gravPlayer()}},{key:"h2e",value:function(e){var t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}}])&&m(t.prototype,i),n&&m(t,n),e}();function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pos=new s.Db,this.type=t.type,this.seedRand=t.seedRand,this.mass=0,this.clock=new s.k,this.skill={skillDrop:null,use:!1,clock:new s.k,obj:null,geometry:null,inUse:!1,delay:this.getRandomInt(5e3,1e4)},this.xyz=t.xyz,this.geometry=null,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.getType()}},{key:"getType",value:function(){"slime"===this.type&&this.renderSlime(),"tower"===this.type&&this.renderTower()}},{key:"renderSlime",value:function(){this.geometry=new s.f(this.xyz.x,this.xyz.y,this.xyz.z),this.geometry.rotateX(.5*Math.PI);var e=this.objObject=new s.R(this.geometry,new s.U({color:4521762,opacity:.75,transparent:!0}));e.up=new s.Db(0,0,1),e.castShadow=!0,e.receiveShadow=!0,e.userData.type="slime"}},{key:"renderTower",value:function(){var e=this.xyz.x/3;this.geometry=new s.m(e,e,this.xyz.y,32),this.geometry.rotateX(.5*Math.PI);var t=this.objObject=new s.R(this.geometry,new s.U({color:16711714,opacity:.75,transparent:!0}));t.up=new s.Db(0,0,1),t.castShadow=!0,t.receiveShadow=!0,t.userData.type="tower",this.skill.geometry=new s.tb(1),this.skill.obj=new s.R(this.skill.geometry,new s.U({color:255})),this.skill.obj.userData.type="skill",this.skill.obj.userData.damage=-10,this.skill.obj.userData.bounce=-2e3,t.add(this.skill.obj)}},{key:"towerFire",value:function(){var e=this.skill.clock.getElapsedTime();if(e<this.skill.delay/1e3)if(e>=1)this.skill.obj.scale.set(1,1,1);else{var t=750-750*Math.exp(-2*e);this.skill.obj.scale.x=t,this.skill.obj.scale.y=t,this.skill.obj.scale.z=t}else this.skill.clock=new s.k,this.skill.obj.scale.set(1,1,1)}},{key:"objRenderLoop",value:function(){this.towerFire()}},{key:"getRandomInt",value:function(e,t){e=Math.ceil(e),t=Math.floor(t);var i=Math.floor(this.seedRand()*(t-e+1))+e;return 0===i?1:i}},{key:"randomSpherePoint",value:function(e){var t=this.seedRand(),i=this.seedRand(),n=2*Math.PI*t,o=Math.acos(2*i-1);return new s.ub(e,o,n)}}])&&y(t.prototype,i),n&&y(t,n),e}();function w(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objectList=[],this.seedRand=t.seedRand,this.pos=t.pos,this.mass=0,this.skins=["/planets/assets/images/ceresl.jpg","/planets/assets/images/earth.jpg","/planets/assets/images/eris.jpg","/planets/assets/images/haumea.jpg","/planets/assets/images/jupiter.jpg","/planets/assets/images/makemake.jpg","/planets/assets/images/mars.jpg","/planets/assets/images/mercury.jpg","/planets/assets/images/neptune.jpg","/planets/assets/images/saturn.jpg","/planets/assets/images/uranus.jpg","/planets/assets/images/venus.jpg"],this.i=t.i;var i=t.i%12;this.skin=this.skins[i],this.scene=t.scene,this.globeRadius=t.globeRadius,this.physicsBody=t.physicsBody,this.world=t.world,this.globeObject=null,this.population=[],this.textureLoader=new s.zb,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this.textureLoader.load(this.skin),t=this.globeObject=new s.R(new s.tb(this.globeRadius,40,40),new s.U({map:e}));t.position.set(this.pos.x,this.pos.y,this.pos.z),t.castShadow=!0,t.receiveShadow=!0;var i={slime:20,tower:10};"easy"===window.globeAPPsettings.difficulty?(i.slime=10,i.tower=0):"medium"===window.globeAPPsettings.difficulty?(i.slime=20,i.tower=5):"difficult"===window.globeAPPsettings.difficulty&&(i.slime=30,i.tower=10),this.objectList=this.objSpawner(i,this.globeRadius);for(var n=0;n<this.objectList.length;n++)t.add(this.objectList[n].objObject),this.objectList[n].objObject.lookAt(t.position),this.objectList[n].objObject.updateMatrixWorld();var o=new a.c(this.globeRadius);this.physicsBody=new a.a({mass:this.mass,position:new a.d(this.pos.x,this.pos.y,this.pos.z),restitution:0,shape:o})}},{key:"objSpawner",value:function(e,t){var i=[];for(var n in e)for(var o=0;o<e[n];o++){var a=this.getRandomInt(t/10,t/2.5),l=this.getRandomInt(t/10,t/2.5),r=this.getRandomInt(t/10,t/2.5),c=new f({seedRand:this.seedRand,xyz:new s.Db(a,l,r),type:n});i.push(c);var h=c.randomSpherePoint(t);c.objObject.position.setFromSpherical(h)}return i}},{key:"getRandomInt",value:function(e,t){e=Math.ceil(e),t=Math.floor(t);var i=Math.floor(this.seedRand()*(t-e+1))+e;return 0===i?1:i}},{key:"randomSpherePoint",value:function(e){var t=this.seedRand(),i=this.seedRand(),n=2*Math.PI*t,o=Math.acos(2*i-1);return new s.ub(e,o,n)}}])&&w(t.prototype,i),n&&w(t,n),e}(),v=i(130),j=i.n(v);function P(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=document.getElementById("gui")}var t,i,n;return t=e,(i=[{key:"init",value:function(){}},{key:"loop",value:function(){for(var e=0,t=0;t<window.player.planets.length;t++)e+=window.player.planets[t].objectList.length;var i=1===window.player.moveDirection.forward||1===window.player.moveDirection.backward||1===window.player.moveDirection.right||1===window.player.moveDirection.left,n=1===window.player.moveDirection.strafeLeft||1===window.player.moveDirection.strafeRight,o=1===window.player.moveDirection.jump,s=1===window.player.moveDirection.dive,a=1===window.player.moveDirection.dash,l="",r="",c="0";null!==window.player.playerTimer&&(c=Math.floor(1e3*window.player.playerTimer.getElapsedTime())/1e3)>0&&0===e&&window.player.playerTimer.stop(),"insanity"===window.globeAPPsettings.difficulty&&(l='<p id="gui--stats--gravity">Gravity: <span>'.concat(Math.floor(100*window.player.attributes.gravity.modifier),"%</span></p>"),r='<p id="gui--stats--bounce">Bounce: <span>'.concat(Math.floor(100*window.player.attributes.bounce.modifier),"%</span></p>")),this.el.innerHTML='<div id="gui--left">\n                                <p>Planets: '.concat(window.globeAPPsettings.planetCount,"</p>\n                                <p>Distance to nearest planet (").concat(window.player.closestPlanet.number+1,"/").concat(window.player.planets.length,"): ").concat(Math.round(window.player.closestDist),"<p>\n                                <p>Slimes left on this planet: ").concat(window.player.closestPlanet.planet.objectList.length,"</p>\n                                <p>Slimes left on all planets: ").concat(e,"</p>\n                                <br>\n                                <p>Time Elapsed: ").concat(c,"</p>\n                                <p>Seed: ").concat(window.globeAPPsettings.seed,"</p>\n                                <p>Difficulty: ").concat(window.globeAPPsettings.difficulty,'</p>\n                                <br>\n                                <p>Controls:</p>\n                                <p class="').concat(i?"activeClass":"",'" id="keys--wasd">move - w a s d</p>\n                                <p class="').concat(n?"activeClass":"",'" id="keys--strafe">strafe - q e</p>\n                                <p class="').concat(o?"activeClass":"",'" id="keys--jump">jump - space</p>\n                                <p class="').concat(s?"activeClass":"",'" id="keys--dive">dive - z</p>\n                                <p class="').concat(a?"activeClass":"",'" id="keys--dash">dash - f</p>\n                            </div>\n                            <div id="gui--right">\n                                <p id="gui--stats--health">Health: <span>').concat(window.player.attributes.health.amount,'</span></p>\n                                <p id="gui--stats--energy">Energy: <span>').concat(window.player.attributes.energy.amount,"</span></p>\n                                ").concat(l,"\n                                ").concat(r,"\n                            </div>\n                            ")}}])&&P(t.prototype,i),n&&P(t,n),e}();function O(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gui=null,this.seedRand=new j.a(window.globeAPPsettings.seed),this.scene=null,this.camera=null,this.tempcamera=null,this.controls=null,this.renderer=null,this.world=null,this.planets=[],this.globe=null,this.objBase=null,this.objPos=null,this.objectList=[],this.player=null,this.playerLight=null,this.playerObject=null,this.renderFunctions=[],this.tmpTrans=null,this.tmpPos=new s.Db,this.tmpQuat=new s.jb,this.mouseCoords=new s.Cb,this.raycaster=new s.nb,this.deltaTime=null,this.clock=new s.k,this.fixedTimeStep=1/60,this.maxSubSteps=3,this.STATE={DISABLE_DEACTIVATION:4}}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.setupworld(),this.setupGraphics(),this.setupPlanets(),this.setupPlayer(),window.gui=new k({player:window.player}),this.render()}},{key:"setupPlayer",value:function(){window.player=new b({planets:this.planets,camera:this.camera,globeRadius:this.planets[0].globeRadius,scene:window.scene,renderer:this.renderer}),this.world.addBody(window.player.physicsBody)}},{key:"setupPlanets",value:function(){for(var e=0,t=[0,0,0],i=window.globeAPPsettings.planetCount>0?window.globeAPPsettings.planetCount:1,n=0;n<i;n++){var o=this.getRandomInt(580,1080);if(n>0)if(e=750+o+this.planets[n-1].globeRadius,n%2==0)switch(this.getRandomInt(1,4)){case 1:t[0]+=e;break;case 2:t[0]-=e;break;case 3:t[2]+=e;break;case 4:t[2]-=e}else t[1]-=e;var a=new s.Db(t[0],t[1],t[2]),l=new g({pos:a,i:n,scene:window.scene,globeRadius:o,physicsBody:this.physicsBody,world:this.world,seedRand:this.seedRand});this.planets.push(l),window.scene.add(l.globeObject),this.world.addBody(l.physicsBody)}}},{key:"setupworld",value:function(){this.world=new a.e,this.world.gravity.set(0,0,0)}},{key:"getRandomInt",value:function(e,t){e=Math.ceil(e),t=Math.floor(t);var i=Math.floor(this.seedRand()*(t-e+1))+e;return 0===i?1:i}},{key:"setupGraphics",value:function(){window.scene=new s.pb,window.scene.background=new s.l(0),window.scene.fog=new s.t(0,25e-8),this.camera=new s.eb(60,window.innerWidth/window.innerHeight,.2,25e3),this.camera.up=new s.Db(0,0,-1);var e=new s.w(16777215,16777215,.1);e.color.setHSL(.6,.6,.6),e.groundColor.setHSL(.1,1,.4),e.position.set(0,50,0),window.scene.add(e);var t=new s.n(16777215,1);t.color.setHSL(.1,1,.95),t.position.set(-1,1.75,1),t.position.multiplyScalar(100),window.scene.add(t),t.castShadow=!0,t.shadow.mapSize.width=2048,t.shadow.mapSize.height=2048,t.shadow.camera.left=-50,t.shadow.camera.right=50,t.shadow.camera.top=50,t.shadow.camera.bottom=-50,t.shadow.camera.far=13500,this.renderer=new s.Fb({antialias:!0}),this.renderer.setClearColor(12571109),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.renderer.shadowMap.enabled=!0}},{key:"render",value:function(){var e=this;requestAnimationFrame((function(){e.render()})),this.world&&this.world.step(this.fixedTimeStep,this.clock.getDelta(),this.maxSubSteps),window.player&&window.player.loop(),window.gui&&window.gui.loop(),this.renderer&&this.renderer.render(window.scene,this.camera)}}])&&O(t.prototype,i),n&&O(t,n),e}();function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M(e);if(t){var o=M(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return R(this,i)}}function R(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(i,e);var t=S(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=t.call(this)).init(),e}return i}(x);function L(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t.settings,this.socket=null,this.delayed=!0,this.connected=!1,this.player=t.player,this.scene=t.scene,this.serverData=null,this.playerList=[],this.playerObjects={},this.delay=200,this.logData={b:!0,t:1e3},this.interval=null,this.ws=null,this.obj=null,this.geometry=null,this.init()}var t,i,n;return t=e,(i=[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}},{key:"init",value:function(){this.id=this.uuidv4(),this.websockets()}},{key:"makePlayers",value:function(){var e=this,t=function(t){if(e.playerList[t].id!==e.id)if(t in e.playerObjects)if(Date.now()-e.playerList[t].time>5e3)window.scene.remove(e.playerObjects[t].playerObject.modelObj),delete e.playerObjects[t];else{var i=e.playerList[t].position,n=e.playerList[t].quaternion;e.playerObjects[t].playerObject.modelObj.model&&(e.playerObjects[t].playerObject.modelObj.model.position.copy(new s.Db(i.x,i.y,i.z)),e.playerObjects[t].playerObject.modelObj.model.quaternion.copy(new s.jb(n.x,n.y,n.z,n.w)),e.playerObjects[t].playerObject.modelObj.model.updateMatrixWorld())}else{e.playerObjects[e.playerList[t].id]=e.playerList[t],e.playerObjects[t].playerObject=new s.cb;var o={model:e.playerList[t].character,color:e.playerList[t].color};e.playerObjects[t].playerObject=new d(o,window.scene,(function(){if(e.playerObjects[t].playerObject){var i=e.playerList[t].position,n=e.playerList[t].quaternion;e.playerObjects[t].playerObject.modelObj.model.position.set(i.x,i.y,i.z),e.playerObjects[t].playerObject.modelObj.model.quaternion.set(n.x,n.y,n.z,n.w),e.playerObjects[t].playerObject.modelObj.model.castShadow=!1,e.playerObjects[t].playerObject.modelObj.model.receiveShadow=!1}}))}};for(var i in this.playerList)t(i)}},{key:"websockets",value:function(){var e=this;this.ws=new WebSocket("ws://"+window.location.hostname),this.ws.binaryType="arraybuffer",this.ws.addEventListener("open",(function(t){e.interval=setInterval((function(){if(window.player.avatar.modelObj.model){var t=window.player.playerObject.getWorldPosition(),i=window.player.avatar.modelObj.model.children[0].getWorldQuaternion();"alien"===window.player.avatar.model&&(i=window.player.playerObject.getWorldQuaternion());var n={x:Math.floor(t.x),y:Math.floor(t.y),z:Math.floor(t.z)},o={x:Math.floor(i.x),y:Math.floor(i.y),z:Math.floor(i.z),w:Math.floor(i.w)},s=e.settings.character,a=e.settings.color,l={position:n,id:e.id,quaternion:o,time:Date.now(),character:s,color:a},r=new ArrayBuffer(8),c=new Int32Array(r);console.log(c),e.ws.send(JSON.stringify(l))}}),e.delay)})),this.ws.addEventListener("close",(function(t){clearInterval(e.interval),console.log(t)})),this.ws.addEventListener("message",(function(t){var i=JSON.parse(t.data);e.playerList=i,e.makePlayers()}))}}])&&L(t.prototype,i),n&&L(t,n),e}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=q(e);if(t){var o=q(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z(this,i)}}function z(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(s,e);var t,i,n,o=I(s);function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this)).init(),e.socket=null,e.initGS(),e}return t=s,(i=[{key:"initGS",value:function(){this.socket=new E(this)}}])&&W(t.prototype,i),n&&W(t,n),s}(x);function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gameStates=["menu","singleplayer","multiplayer"],this.gameState="menu",this.state=null,this.menu=null,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){this.setupEventHandlers(),this.stateChange(this.gameState)}},{key:"stateChange",value:function(e){this.gameState=e,"menu"===e&&(this.menu?this.menu.toggleMenu():this.menu=new o(this)),"singleplayer"===e&&(this.state=new T),"multiplayer"===e&&(this.state=new G)}},{key:"setupEventHandlers",value:function(){var e=this;window.addEventListener("keydown",(function(t){e.handleKeyDown(t)}),!1)}},{key:"handleKeyDown",value:function(e){"Escape"===e.key&&this.stateChange("menu")}}])&&_(t.prototype,i),n&&_(t,n),e}();window.globeAPPsettings=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gameTypes=["singleplayer","multiplayer"],this.gameType="singleplayer",this.seed="1",this.planetCount="12",this.difficulties=["easy","medium","difficult","insanity"],this.difficulty="easy",this.characters=["robot","alien"],this.character="alien",this.color="rgb(255,0,255)",this.server="http://localhost",this.savedGameFile="",this.options={sound:!1,controls:{forward:"w",backwards:"s",strafeleft:"q",straferight:"e",turnleft:"a",turnright:"d",jump:" ",dash:"f",dive:"z",action1:"1",action2:"2",action3:"3",action4:"4",action5:"5",action6:"6",action7:"7",action8:"8",action9:"9",action10:"10"},graphics:{viewdistance:500,texturequality:["fair","good","best"]}}},window.globeapp=new H}});